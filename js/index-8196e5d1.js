import{ad as ne,C as de,ae as ge,af as I,d as q,T as he,S as ce,h as x,r as X,G as $,ag as Q,q as Ne,s as ke,ah as Ve,o as V,c as B,f as le,u as n,n as z,a5 as K,i as a,j as c,L as D,R as we,ai as Ee,Q as te,k as Y,aj as Ie,ak as Ce,$ as Z,_ as me,al as Se,a0 as pe,P as Pe,Z as Ae,m as ae,g as P,t as oe,e as Fe,a8 as Te,a9 as re}from"./index-7145d906.js";import{E as $e}from"./el-overlay-54ff3589.js";import{E as De,a as Be}from"./el-form-item-37c64c9e.js";import{E as fe}from"./el-input-a8b97c2f.js";import{_ as Le,E as Ue}from"./index-618ec6bb.js";import"./el-checkbox-1835af1c.js";import"./el-select-f2af1389.js";import{E as Re}from"./el-button-3b52053a.js";import{h as se}from"./index-cd4eb7cd.js";import{C as be,I as ee,U as O}from"./event-9519ab40.js";import{i as j}from"./isNil-c75b1b34.js";import{b as Me,a as xe,c as Ke}from"./use-form-item-ff632249.js";import{t as Oe,d as ie}from"./error-78e43d3e.js";import"./el-scrollbar-5153f5ea.js";import"./refs-0ea3f117.js";import"./baseClone-cd11f5db.js";import"./Uint8Array-636aa068.js";import"./plugin-vueexport-helper-c27b6911.js";import"./isEqual-0384efb4.js";const ze=100,Ye=600,ue={beforeMount(r,w){const d=w.value,{interval:l=ze,delay:C=Ye}=ne(d)?{}:d;let o,m;const s=()=>ne(d)?d():d.handler(),g=()=>{m&&(clearTimeout(m),m=void 0),o&&(clearInterval(o),o=void 0)};r.addEventListener("mousedown",A=>{A.button===0&&(g(),s(),document.addEventListener("mouseup",()=>g(),{once:!0}),m=setTimeout(()=>{o=setInterval(()=>{s()},l)},C))})}},je=de({id:{type:String,default:void 0},step:{type:Number,default:1},stepStrictly:Boolean,max:{type:Number,default:Number.POSITIVE_INFINITY},min:{type:Number,default:Number.NEGATIVE_INFINITY},modelValue:Number,readonly:Boolean,disabled:Boolean,size:ge,controls:{type:Boolean,default:!0},controlsPosition:{type:String,default:"",values:["","right"]},valueOnClear:{type:[String,Number,null],validator:r=>r===null||I(r)||["min","max"].includes(r),default:null},name:String,label:String,placeholder:String,precision:{type:Number,validator:r=>r>=0&&r===Number.parseInt(`${r}`,10)},validateEvent:{type:Boolean,default:!0}}),qe={[be]:(r,w)=>w!==r,blur:r=>r instanceof FocusEvent,focus:r=>r instanceof FocusEvent,[ee]:r=>I(r)||j(r),[O]:r=>I(r)||j(r)},Ge=["aria-label","onKeydown"],He=["aria-label","onKeydown"],Je=q({name:"ElInputNumber"}),We=q({...Je,props:je,emits:qe,setup(r,{expose:w,emit:d}){const l=r,{t:C}=he(),o=ce("input-number"),m=x(),s=X({currentValue:l.modelValue,userInput:null}),{formItem:g}=Me(),A=$(()=>I(l.modelValue)&&l.modelValue<=l.min),G=$(()=>I(l.modelValue)&&l.modelValue>=l.max),H=$(()=>{const e=_(l.step);return Q(l.precision)?Math.max(_(l.modelValue),e):(e>l.precision,l.precision)}),L=$(()=>l.controls&&l.controlsPosition==="right"),v=xe(),i=Ke(),h=$(()=>{if(s.userInput!==null)return s.userInput;let e=s.currentValue;if(j(e))return"";if(I(e)){if(Number.isNaN(e))return"";Q(l.precision)||(e=e.toFixed(l.precision))}return e}),y=(e,t)=>{if(Q(t)&&(t=H.value),t===0)return Math.round(e);let u=String(e);const f=u.indexOf(".");if(f===-1||!u.replace(".","").split("")[f+t])return e;const J=u.length;return u.charAt(J-1)==="5"&&(u=`${u.slice(0,Math.max(0,J-1))}6`),Number.parseFloat(Number(u).toFixed(t))},_=e=>{if(j(e))return 0;const t=e.toString(),u=t.indexOf(".");let f=0;return u!==-1&&(f=t.length-u-1),f},E=(e,t=1)=>I(e)?y(e+l.step*t):s.currentValue,U=()=>{if(l.readonly||i.value||G.value)return;const e=Number(h.value)||0,t=E(e);F(t),d(ee,s.currentValue)},R=()=>{if(l.readonly||i.value||A.value)return;const e=Number(h.value)||0,t=E(e,-1);F(t),d(ee,s.currentValue)},M=(e,t)=>{const{max:u,min:f,step:b,precision:S,stepStrictly:J,valueOnClear:W}=l;u<f&&Oe("InputNumber","min should not be greater than max.");let k=Number(e);if(j(e)||Number.isNaN(k))return null;if(e===""){if(W===null)return null;k=Se(W)?{min:f,max:u}[W]:W}return J&&(k=y(Math.round(k/b)*b,S)),Q(S)||(k=y(k,S)),(k>u||k<f)&&(k=k>u?u:f,t&&d(O,k)),k},F=(e,t=!0)=>{var u;const f=s.currentValue,b=M(e);if(!t){d(O,b);return}f!==b&&(s.userInput=null,d(O,b),d(be,b,f),l.validateEvent&&((u=g==null?void 0:g.validate)==null||u.call(g,"change").catch(S=>ie())),s.currentValue=b)},p=e=>{s.userInput=e;const t=e===""?null:Number(e);d(ee,t),F(t,!1)},N=e=>{const t=e!==""?Number(e):"";(I(t)&&!Number.isNaN(t)||e==="")&&F(t),s.userInput=null},T=()=>{var e,t;(t=(e=m.value)==null?void 0:e.focus)==null||t.call(e)},ve=()=>{var e,t;(t=(e=m.value)==null?void 0:e.blur)==null||t.call(e)},_e=e=>{d("focus",e)},ye=e=>{var t;d("blur",e),l.validateEvent&&((t=g==null?void 0:g.validate)==null||t.call(g,"blur").catch(u=>ie()))};return Ne(()=>l.modelValue,e=>{const t=M(s.userInput),u=M(e,!0);!I(t)&&(!t||t!==u)&&(s.currentValue=u,s.userInput=null)},{immediate:!0}),ke(()=>{var e;const{min:t,max:u,modelValue:f}=l,b=(e=m.value)==null?void 0:e.input;if(b.setAttribute("role","spinbutton"),Number.isFinite(u)?b.setAttribute("aria-valuemax",String(u)):b.removeAttribute("aria-valuemax"),Number.isFinite(t)?b.setAttribute("aria-valuemin",String(t)):b.removeAttribute("aria-valuemin"),b.setAttribute("aria-valuenow",String(s.currentValue)),b.setAttribute("aria-disabled",String(i.value)),!I(f)&&f!=null){let S=Number(f);Number.isNaN(S)&&(S=null),d(O,S)}}),Ve(()=>{var e;const t=(e=m.value)==null?void 0:e.input;t==null||t.setAttribute("aria-valuenow",`${s.currentValue}`)}),w({focus:T,blur:ve}),(e,t)=>(V(),B("div",{class:z([n(o).b(),n(o).m(n(v)),n(o).is("disabled",n(i)),n(o).is("without-controls",!e.controls),n(o).is("controls-right",n(L))]),onDragstart:t[1]||(t[1]=Z(()=>{},["prevent"]))},[e.controls?le((V(),B("span",{key:0,role:"button","aria-label":n(C)("el.inputNumber.decrease"),class:z([n(o).e("decrease"),n(o).is("disabled",n(A))]),onKeydown:K(R,["enter"])},[a(n(te),null,{default:c(()=>[n(L)?(V(),D(n(we),{key:0})):(V(),D(n(Ee),{key:1}))]),_:1})],42,Ge)),[[n(ue),R]]):Y("v-if",!0),e.controls?le((V(),B("span",{key:1,role:"button","aria-label":n(C)("el.inputNumber.increase"),class:z([n(o).e("increase"),n(o).is("disabled",n(G))]),onKeydown:K(U,["enter"])},[a(n(te),null,{default:c(()=>[n(L)?(V(),D(n(Ie),{key:0})):(V(),D(n(Ce),{key:1}))]),_:1})],42,He)),[[n(ue),U]]):Y("v-if",!0),a(n(fe),{id:e.id,ref_key:"input",ref:m,type:"number",step:e.step,"model-value":n(h),placeholder:e.placeholder,readonly:e.readonly,disabled:n(i),size:n(v),max:e.max,min:e.min,name:e.name,label:e.label,"validate-event":!1,onWheel:t[0]||(t[0]=Z(()=>{},["prevent"])),onKeydown:[K(Z(U,["prevent"]),["up"]),K(Z(R,["prevent"]),["down"])],onBlur:ye,onFocus:_e,onInput:p,onChange:N},null,8,["id","step","model-value","placeholder","readonly","disabled","size","max","min","name","label","onKeydown"])],34))}});var Qe=me(We,[["__file","/home/runner/work/element-plus/element-plus/packages/components/input-number/src/input-number.vue"]]);const Ze=pe(Qe),Xe=de({type:{type:String,values:["primary","success","warning","info","danger","default"],default:"default"},underline:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},href:{type:String,default:""},icon:{type:Pe}}),et={click:r=>r instanceof MouseEvent},tt=["href"],nt=q({name:"ElLink"}),lt=q({...nt,props:Xe,emits:et,setup(r,{emit:w}){const d=r,l=ce("link"),C=$(()=>[l.b(),l.m(d.type),l.is("disabled",d.disabled),l.is("underline",d.underline&&!d.disabled)]);function o(m){d.disabled||w("click",m)}return(m,s)=>(V(),B("a",{class:z(n(C)),href:m.disabled||!m.href?void 0:m.href,onClick:o},[m.icon?(V(),D(n(te),{key:0},{default:c(()=>[(V(),D(Ae(m.icon)))]),_:1})):Y("v-if",!0),m.$slots.default?(V(),B("span",{key:1,class:z(n(l).e("inner"))},[ae(m.$slots,"default")],2)):Y("v-if",!0),m.$slots.icon?ae(m.$slots,"icon",{key:2}):Y("v-if",!0)],10,tt))}});var at=me(lt,[["__file","/home/runner/work/element-plus/element-plus/packages/components/link/src/link.vue"]]);const ot=pe(at);const rt={class:"w-full h-full"},st={class:"dialog-footer"},Ct=q({__name:"index",setup(r){const w=x("/api/role"),d=x(),l=x(!1),C=x(),o=X({name:"",key:"",sort:0,remark:""}),m=X({name:[{required:!0,trigger:"blur"}],key:[{required:!0,trigger:"blur"}],sort:[{required:!0,trigger:"blur"}]}),s=X({showName:""}),g=()=>{var v;return(v=C.value)==null?void 0:v.getList()},A=()=>{d.value.validate(v=>{if(v){const i=JSON.parse(JSON.stringify(o));console.log("data ==>",i),s.showName=="add"&&se.post(w.value,i).then(h=>{const{code:y,message:_}=h;y===200&&(re.success(_),l.value=!1,g())}),s.showName=="edit"&&(delete i.password,se.put(w.value,i).then(h=>{const{code:y,message:_}=h;y===200&&(re.success(_),l.value=!1,g())}))}})},G=()=>{s.showName="add",l.value=!0,H()},H=()=>{Object.keys(o).forEach(v=>o[v]=""),o.sort=0},L=v=>{Object.keys(v).forEach(i=>o[i]=v[i]),s.showName="edit",l.value=!0};return(v,i)=>{const h=fe,y=De,_=Re,E=Ue,U=ot,R=Ze,M=Be,F=$e;return V(),B("main",rt,[a(Le,{ref_key:"CURDRef",ref:C,api:n(w)},{search:c(({query:p,getList:N})=>[a(y,null,{default:c(()=>[a(h,{style:{width:"200px"},onKeyup:K(N,["enter"]),placeholder:"title",modelValue:p.title,"onUpdate:modelValue":T=>p.title=T,clearable:""},null,8,["onKeyup","modelValue","onUpdate:modelValue"])]),_:2},1024)]),buttons:c(({tableCheck:p,handleDelete:N})=>[a(_,{plain:"",type:"primary",onClick:G},{default:c(()=>[P("新增")]),_:1}),a(_,{plain:"",type:"danger",disabled:p.length==0,onClick:T=>N()},{default:c(()=>[P("删 除")]),_:2},1032,["disabled","onClick"])]),table:c(({handleDelete:p})=>[a(E,{type:"index",align:"center",label:"序号",width:"70"}),a(E,{type:"selection",align:"center",width:"55"}),a(E,{"show-overflow-tooltip":"",align:"center",prop:"name",label:"角色名称"}),a(E,{"show-overflow-tooltip":"",align:"center",prop:"key",label:"角色字符"},{default:c(({row:N})=>[a(U,{type:"primary",underline:!1},{default:c(()=>[P(oe(N.key),1)]),_:2},1024)]),_:1}),a(E,{"show-overflow-tooltip":"",align:"center",prop:"sort",label:"排序"}),a(E,{"show-overflow-tooltip":"",align:"center",prop:"remark",label:"remark"}),a(E,{"show-overflow-tooltip":"",align:"center",label:"创建时间"},{default:c(({row:N})=>[P(oe(v.dayjs(N.createdAt).format("YYYY-MM-DD HH:mm:ss")),1)]),_:1}),a(E,{fixed:"right",label:"操作",align:"center",width:"150"},{default:c(({row:N})=>[a(_,{onClick:T=>p(N.id),link:"",type:"danger"},{default:c(()=>[P("删除")]),_:2},1032,["onClick"]),a(_,{onClick:T=>L(N),link:"",type:"warning"},{default:c(()=>[P("编辑")]),_:2},1032,["onClick"])]),_:2},1024)]),_:1},8,["api"]),a(F,{modelValue:n(l),"onUpdate:modelValue":i[5]||(i[5]=p=>Te(l)?l.value=p:null),title:n(s).showName,width:"500",draggable:""},{footer:c(()=>[Fe("span",st,[a(_,{onClick:i[4]||(i[4]=p=>l.value=!1)},{default:c(()=>[P("取消")]),_:1}),a(_,{type:"warning",onClick:H},{default:c(()=>[P("清空")]),_:1}),a(_,{type:"primary",onClick:A},{default:c(()=>[P(" 提交 ")]),_:1})])]),default:c(()=>[a(M,{ref_key:"formRef",ref:d,model:n(o),"status-icon":"",rules:n(m),"label-width":"100px",class:"demo-form"},{default:c(()=>[a(y,{label:"角色名称",prop:"name"},{default:c(()=>[a(h,{modelValue:n(o).name,"onUpdate:modelValue":i[0]||(i[0]=p=>n(o).name=p),autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(y,{label:"角色字符",prop:"key"},{default:c(()=>[a(h,{modelValue:n(o).key,"onUpdate:modelValue":i[1]||(i[1]=p=>n(o).key=p),autocomplete:"off"},null,8,["modelValue"])]),_:1}),a(y,{label:"排序",prop:"sort"},{default:c(()=>[a(R,{modelValue:n(o).sort,"onUpdate:modelValue":i[2]||(i[2]=p=>n(o).sort=p),min:0,precision:0,"controls-position":"right"},null,8,["modelValue"])]),_:1}),a(y,{label:"remark",prop:"remark"},{default:c(()=>[a(h,{modelValue:n(o).remark,"onUpdate:modelValue":i[3]||(i[3]=p=>n(o).remark=p),type:"textarea",rows:4,autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{Ct as default};
