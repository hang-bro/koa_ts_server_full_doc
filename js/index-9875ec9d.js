import{d as C,r as B,h as f,o as F,c as N,i as s,j as l,g,e as h,u as $}from"./index-2b53d579.js";import{E as V,a as j}from"./el-upload-d6bea881.js";import{E as D}from"./el-button-dbcff3d1.js";import{h as d}from"./index-189e2db8.js";import"./error-78e43d3e.js";import"./isNil-c75b1b34.js";import"./use-form-item-72a3afbe.js";import"./baseClone-b2238643.js";import"./Uint8Array-73bf408d.js";import"./isEqual-2bf0e3e7.js";const R={class:"w-full h-full p-5 bg-gray-100"},T=h("div",{class:"el-upload__tip"},"jpg/png files with a size less than 500kb",-1),_=1024*1024*10,K=C({__name:"index",setup(U){const n=B({percentage:0}),b=[{color:"#f56c6c",percentage:20},{color:"#e6a23c",percentage:40},{color:"#5cb87a",percentage:60},{color:"#1989fa",percentage:80},{color:"#6f7ad3",percentage:100}],v=f(),p=f(),k=e=>{p.value=e.raw};function i(e){e=e||0,console.log("index ==>",e);const o=p.value,[a,c]=o.name.split("."),t=e*_;if(console.log("start > file.size ==>",t,o.size),t>o.size){console.log("文件上传完成,开始合并"),n.percentage=100,z(o.name);return}const m=o.slice(t,t+_),w=`${a}.${e}.${c}`,y=new File([m],w),u=new FormData;u.append("file",y),d.upload("/api/upload/slice",u).then(r=>{console.log(r),n.percentage=t/o.size*100,e+=1,setTimeout(()=>i(e),200)});function z(r){d.post("/api/upload/merge",{name:r}).then(E=>{console.log(E)})}}return(e,o)=>{const a=D,c=V,t=j;return F(),N("main",R,[s(c,{limit:1,ref_key:"uploadRef",ref:v,class:"upload-demo","auto-upload":!1,onChange:k},{trigger:l(()=>[s(a,{type:"primary"},{default:l(()=>[g("选择文件")]),_:1})]),tip:l(()=>[T]),_:1},512),s(a,{class:"ml-3",type:"success",onClick:o[0]||(o[0]=m=>i())},{default:l(()=>[g(" upload to server ")]),_:1}),h("div",null,[s(t,{type:"dashboard",percentage:+$(n).percentage.toFixed(2),color:b},null,8,["percentage"])])])}}});export{K as default};
